tab0020 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.002", header = T)
tab0078 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.0078", header = T)
tab0313 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.0313", header = T)
tab0625<- read.table("Documents/Prediction/fev1fvc_bykinship_0.0625", header = T)
tab0938 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.0938", header = T)
tab1 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.1", header = T)
tab125 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.125", header = T)
tab2 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.2", header = T)
tab25 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.25", header = T)
tab3 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.3", header = T)
tab375 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.375", header = T)
tab4 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.4", header = T)
tab5 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.5", header = T)
tab6 <- read.table("Documents/Prediction/fev1fvc_bykinship_0.6", header = T)

values <- c(0.002, 0.0078, 0.0313, 0.0625, 0.0938, 0.1, 0.125, 0.2, 0.25, 0.3, 0.375, 0.4, 0.5,0.6)

myPlotlist<- c()
new<- c()
inds <- c()
correlations <- c()
dfList <- list(tab0020, tab0078, tab0313, tab0625, tab0938, tab1, tab125, tab2, tab25, tab3, tab375, tab4, tab5, tab6)
for (i in 1:length(dfList)) {
    a <- cor.test(dfList[[i]]$Pred, dfList[[i]]$Obs)
    correlations <- c(correlations, a$estimate)
    inds <- c(inds, dim(dfList[[i]])[1])
    xtab <- cbind(dfList[[i]], values[i])
    colnames(xtab) <- c(colnames(xtab)[1:4], "Kinship")
    new <- rbind(new, xtab)
    assign(paste("plot_",i,sep=""), ggplot(xtab, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw())
    myPlotlist <- c(myPlotlist, paste("plot_",i,sep=""))
}


ggplot(tab0020, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives))+ theme_bw()
ggplot(tab0078, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab0313, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab0625, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab0938, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab1, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab125, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab2, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab25, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab3, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab375, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab4, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab5, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()
ggplot(tab6, aes(Obs, Pred))+ geom_point(aes(size=totalrelatives, color=totalrelatives))+ theme_bw()


plot(values, (correlations)^2, xlab = "kinship values", ylab = "R^2", main = "Correlation of of Observed and Predicted FEV1/FVC", ylim=c(0.05, 0.17))
points(values, (correlations)^2,  type = "lwd")
abline(0.14, 0, col="blue")
abline(0.056169, 0, col="red")
text(0.14,0.15, label="R^2 for prediction from siblings and parents", col="blue")
text(0.3,0.065, label="R^2 for prediction from parents only", col="red")
